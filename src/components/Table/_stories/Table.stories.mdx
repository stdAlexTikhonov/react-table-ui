import {
  Meta,
  Source,
  Story
} from '@storybook/addon-docs';

<Meta
  title="Table/Table/Overview"
  parameters={{
    design: {
      type: 'figma',
      url: 'https://www.figma.com/file/Vp0QCIYWhOb4zHMUsiMskE/DS2.0-Table?node-id=101%3A52228&t=65Qn53DlL4cKr5R0-0'
    }
  }}
/>

###  Базовый компонент таблицы

  Для того чтобы вывести простую таблицу достаточно задать параметры data и columns

###  Таблица с объединением ячеек по вертикали

  Для объединения ячеек по вертикали укажите в свойстве compound идентификатор колонки ячейки котоой хотите объединить. Таблица объединит ячейки идущие друг за
  другом 
  если значения будут повторяться.
  Если вы хотите объединить ячейки в нескольких колонках укажите в compound массив с идентификаторами колонок.
  Если вы хотите включить объединение во всех колонках - укажите compound: true
  
  Примеры значений:
   - compound: true
   - compound: 'brigadier-0'
   - compound: ['status-0', 'progress-0']

###  Таблица с редактируемыми полями

  Для включения возможности изменения, выделения, копирования и вставки укажите meta свойство editable
  
  Пример:
   - meta: { editable: true }

###  Таблица с расрывающимися строками 

  Для включения этой функции необходимо:
   - Указать enableExpanding: true
   - В структуре data, в объекте строки, которая должна раскрываться, добавить поле которое будет отвечать за вложенные данные в данном примере subRows, и
     передать этому полю значением массив схожий семантически с родительским объектом/массивом
   - Задать свойсто getSubRows: (row: Row) => row.subRows - функция к которой обращается таблица для получения подстрок. Функция должна возвращать значение поля
     содержащего подстроки(массив) каждой строки.
   - Переопределить параметр cell в конфигурации колонок у колонки ячейки которой будут отвечать за раскрытие строк

###  Таблица с фильтрацией

  Для того чтобы включить фильтрацию задайте свойство
  
   - enableColumnFilters: true
  
  Фильтры добавятся для всех колонок
  
  Если необходимо отключить фильтры на некоторых из них, в конфигурации колонок можно задать
  
   - enableColumnFilter: false
  
  для отдельной колонки

###  Таблица с фильтрацией с запросами на бэкенд

  Для того чтобы включить фильтрацию задайте свойство
  
   - enableColumnFilters: true
  
  Для того чтобы изменения в фильтрах отправляли запрос на бэкенд воспользуйтесь методом onFilterChange
  
   - meta: { onFilterChange: ({ id, mode, value}: FilterState) => {} }
  
  Для работы с множественным выбором и добавления подсказок при подключение бэкенд задайте метод loadUniqueValues
  
   - meta: { loadUniqueValues: (column: string) => {} }
  
  метод loadUniqueValues должен возвращать уникальные значения для колонок.

###  Таблица с футером

  Для того чтобы добавить футер используйте свойство meta: { enableFooter }
  
  Для числовых колонок автоматически будет показываться сумма значений колонки.
  
  В футере можно вывести свой текст или элемент воспользовавшись свойством footer в конфигурации колонок.
  

###  Таблица с глобальным поиском

  Глобальный поиск реализован через компонент Table.GlobalFilter который параметром принимает объект table

###  Таблица с группировкой колонок

  В конфигурации колонок у каждой колонки можно задать свойство columns которое так же принимает массив колонок.
  
  {
     id: 'column1',
     columns: [
       {
         id: 'inner-column-1'
       },
       {
         id: 'inner-column-1'
       }
     ]
   },

###  Таблица с группировкой колонок и включеной виртуализацией

  В конфигурации колонок у каждой колонки можно задать свойство columns которое так же принимает массив колонок.
  
  {
     id: 'column1',
     columns: [
       {
         id: 'inner-column-1'
       },
       {
         id: 'inner-column-1'
       }
     ]
   },
  
  Чтобы включить горизонтальную виртуализацию:
   - meta: { enableColumnVirtualization: true }
  
  Вертикальную:
   - meta: { enableRowVirtualization: true }
  

###  Таблица с динамической подгрузкой

  
  Данный пример реализован с применением библиотеки @tanstack/react-query
 
  Взаимодействие таблицы и хука useInfiniteQuery происходит через:
   - ref ссылку на компонент таблицы
   - контролируемое состояние SortingState
   - контролируемое состояние PaginationState
   - метод onScroll компонента таблицы
   - enableRowVirtualization: true
   - pageCount
  
  
  Пример минимальной конфигурации:
   columns: columns
   state: {
     sorting,
     pagination
   },
   pageCount,
   onSortingChange: setSorting,
   onPaginationChange: setPagination,
   data: flatData,
   meta: {
     enableRowVirtualization: true,
   }
  
  Параметры которые необходимо передать в Table.Component
   - onScroll
   - ref
   - loading
  
  
  Смотрите в примере
  
/

###  Таблица с контролируемой пагинацией

  Для того чтобы включить контролируемую пагинацию
   
   - manualPagination: true,
   - pageCount - общее количество страниц
  
  Создайте стейт пагинации
    - const [pagination, setPagination] = useState({ pageIndex: 0, pageSize: 20 });
  
  И свяжите его с таблицей 
   - state: { pagination } 
   - onPaginationChange: setPagination
  
/

###  Таблица с множественным выбором

  
  Импортируйте метод getMultipleSelect из библиотеки и добавте результат выполнения этой функции в колонки
  
   - const multipleSelect = getMultipleSelect();
   - columns: [multipleSelect, ...columns]
  
  Включите выбор строки
   
   - enableRowSelection: true
  

###  Таблица с пагинацией

  Для того чтобы включить пагинацию добавьте мета свойство pagination
  
   - meta: { pagination: true }
  

###  Таблица с возможностью выбора строки

  Для того чтобы включить выбор строки включите свойство enableRowSelection
  
   - enableRowSelection: true
  
  Есть возможноть контролиовать выбор через state и onRowSelectionChange
  
   - const [selection, setSelection] = useState({})
  
   - state: { rowSelection: selection }
   - onRowSelectionChange: setSelection
  

###  Таблица с виртуализацией

  Виртуализация может быть как горизонтальная, так и вертикальная для включения используйте:
  
   - meta: { enableRowVirtualization: true } - для вертикальной
   - meta: { enableColumnVirtualization: true } - для горизонтальной
  